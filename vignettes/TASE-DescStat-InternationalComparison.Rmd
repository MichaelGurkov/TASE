
```{r Import_wfe_data}

exchanges_list = read_csv(paste0(Sys.getenv("USERPROFILE"),
                                 "\\OneDrive - Bank Of Israel\\",
                                 "Data\\TASE liquidity\\",
                                 "OECD_Exchange_list.csv"),
                          show_col_types = FALSE) %>% 
  rename_all(tolower) %>% 
  pivot_longer(-country, values_to = "exchange_name") %>% 
  select(-name)

wfe_df = read_csv(paste0(Sys.getenv("USERPROFILE"),
                            "\\OneDrive - Bank Of Israel\\Data",
                            "\\TASE liquidity\\WFE\\wfe_data.csv"),
                     show_col_types = FALSE) %>%
  rename_all(tolower)

wfe_df = wfe_df %>%
  rename_all(~str_remove_all(.," ")) %>%
  rename_all(~str_replace(.,"name","_name")) %>% 
  mutate(across(value, as.numeric)) %>% 
  filter(!is.na(value))

wfe_df = wfe_df %>% 
  mutate(indicator_name = str_remove_all(indicator_name,
                                         "Total Equity Market - ")) %>% 
  mutate(indicator_name = str_remove_all(indicator_name, " \\(Total\\)")) %>% 
  mutate(indicator_name = str_replace_all(indicator_name,pattern = "\\s","_"))

wfe_df = wfe_df%>% 
  inner_join(exchanges_list,by = "exchange_name") %>% 
  select(year, country, exchange_name, indicator_name, value)

rm(exchanges_list)


```


\subsection{Delistings}


```{r delisting_comps_by_year}

wfe_df %>% 
  filter(indicator_name %in% c("Number_of_delistings",
                             "Number_of_listed_companies")) %>% 
  pivot_wider(id_cols = c("year", "exchange_name"),
              names_from = indicator_name,values_from = value) %>% 
  mutate(delistings_share = Number_of_delistings / Number_of_listed_companies) %>% 
  group_by(year) %>% 
  summarise(avg_delisting_share = mean(delistings_share, na.rm = TRUE)) %>% 
  filter(is.finite(avg_delisting_share)) %>% 
  ggplot(aes(as.character(year), avg_delisting_share, group = 1)) + 
  geom_line() + 
  scale_y_continuous(labels = scales::percent_format()) + 
  xlab(NULL) + ylab(NULL) + ggtitle("Average delistings share in OECD countries")
  
    



```

Delisting activity peak is at 2007-2011 probably reflects both the Global Financial Crises and Europe's sovereign debt crises.


```{r delisting_comps_by_exchange}

wfe_df %>% 
  filter(indicator_name %in% c("Number_of_delistings",
                             "Number_of_listed_companies")) %>% 
  pivot_wider(id_cols = c("year", "exchange_name"),
              names_from = indicator_name,values_from = value) %>% 
  mutate(delistings_share = Number_of_delistings / Number_of_listed_companies) %>% 
  group_by(exchange_name) %>% 
  summarise(avg_delisting_share = mean(delistings_share, na.rm = TRUE)) %>% 
  filter(is.finite(avg_delisting_share)) %>% 
  ggplot(aes(avg_delisting_share, reorder(exchange_name, avg_delisting_share))) + 
  geom_col(aes(fill = (exchange_name == "Tel-Aviv Stock Exchange"))) +
  scale_fill_manual(values = c("grey","lightblue")) + 
  scale_x_continuous(labels = scales::percent_format()) + 
  xlab(NULL) + ylab(NULL) + 
  ggtitle("Average delistings share by stock exchange") + 
  theme(legend.position = "none")
  

```

Israel is characterized by relatively low delisting rate (lower third) among OECD exchanges
 
\subsection{Issues}


```{r ipo_comps_by_year}

wfe_df %>% 
  filter(indicator_name %in% c("Number_of_new_listings",
                             "Number_of_listed_companies")) %>% 
  pivot_wider(id_cols = c("year", "exchange_name"),
              names_from = indicator_name,values_from = value) %>% 
  mutate(new_listings_share = Number_of_new_listings /
           Number_of_listed_companies) %>% 
  group_by(year) %>% 
  summarise(avg_new_listings_share = mean(new_listings_share,
                                          na.rm = TRUE)) %>% 
  filter(is.finite(avg_new_listings_share)) %>% 
  ggplot(aes(as.character(year), avg_new_listings_share, group = 1)) + 
  geom_line() + 
  scale_y_continuous(labels = scales::percent_format()) + 
  xlab(NULL) + ylab(NULL) + 
  ggtitle("Average IPO share in OECD countries")

  
    



```


```{r ipo_comps_by_exchange}

wfe_df %>% 
  filter(indicator_name %in% c("Number_of_new_listings",
                             "Number_of_listed_companies")) %>% 
  pivot_wider(id_cols = c("year", "exchange_name"),
              names_from = indicator_name,values_from = value) %>% 
  mutate(ipo_share = Number_of_new_listings / Number_of_listed_companies) %>% 
  group_by(exchange_name) %>% 
  summarise(avg_ipo_share = mean(ipo_share, na.rm = TRUE)) %>% 
  filter(is.finite(avg_ipo_share)) %>% 
  ggplot(aes(avg_ipo_share, reorder(exchange_name, avg_ipo_share))) + 
  geom_col(aes(fill = (exchange_name == "Tel-Aviv Stock Exchange"))) +
  scale_fill_manual(values = c("grey","lightblue")) + 
  scale_x_continuous(labels = scales::percent_format()) + 
  xlab(NULL) + ylab(NULL) + 
  ggtitle("Average IPO share by stock exchange") + 
  theme(legend.position = "none")
  

```
Similar to delisting activity Israel's issuence activity seems to be relatively low (lower third) among OECD exchanges
