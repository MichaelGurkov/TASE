---
title: "Work outline"
output: pdf_document
---

```{r setup, include=FALSE,}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

```


```{r Set_parameters}

filepath = paste0(sub("Desktop","",file.path(Sys.getenv("USERPROFILE"),
                                             "Desktop",fsep="\\")),
                  "Documents\\Data\\TASE\\",
                     "TASE_Liquidity\\quarterly regression updated.csv")


x_vars = c("Leverage","MB","Insider_Ownership")

```


```{r Import_data}

library(tidyverse)

library(xts)

library(stargazer)

df = read.csv(filepath)

delisted_firms = unique(df$MSP_HVR[df$delisted == 1])

df = df %>% 
  mutate(DATE = as.yearqtr(DATE, format = "%d/%m/%Y")) %>% 
  group_by(MSP_HVR) %>% 
  mutate(delisted = cumsum(delisted))

# Rename vars

df = df %>% 
  rename(Total_Assets = sh_necs,
         Total_Liabilities = sh_hth,
         Market_value = erh_shuk,
         Insider_Ownership = public_share,
         Turnover = mhzr_shk,
         Total_Equity = honazmi,
         Total_Revenue = sh_hahn)


# Mutate variables

df = df %>% 
  mutate(Leverage = Total_Assets / Total_Liabilities,
         MB = Market_value / Total_Equity)





```


```{r Run_regression}

logit_res = glm(formula = formula(paste("delisted ~",
                                        paste0(x_vars, collapse = "+"))),
                family = binomial(link = "logit"),
                data = df)

```


\section{Introduction}

The purpose of the work is to identify the reasons
of firm's delistings from trade. The method is a logit regression that evaluates firm's characteristics in a sample
that consists of delisted firms and matched trading firms.

\section{Empirical specification}

\begin{align*}
	Pr(Delisting)  = \alpha & + \beta_{1} Leverage + \beta_{2} MB  
	                          + \beta_{3} CAPEX  + \beta_{4}ROA\\ 
	                        & + \beta{5} FreeCashFlow 
	                          + \beta_{6} InsiderOwnership \\
                          & + \beta_{7} Size + \beta_{8} TradeVolume 
                            + \beta_{9} Illiqudity
\end{align*}

Where:


\section{Descriptive Stats}

The sample consists of `r #length(unique(df$MSP_HVR))` firms,
out of which `r #length(unique(df$MSP_HVR[df$delisted == 1]))` delisted from trading. The sample period is `r #paste(range(df$DATE, na.rm = TRUE), collapse = "-")`

```{r desc_stat, results="asis"}

stargazer(df %>% 
            ungroup() %>% 
            select(delisted,x_vars) %>% 
            as.data.frame(),
          header = FALSE,
          omit.summary.stat = c("p25","p75","n"))

```


\section{Results}

```{r output_regression, results="asis"}

stargazer(logit_res, header = FALSE, dep.var.labels = "Delisted")

```


